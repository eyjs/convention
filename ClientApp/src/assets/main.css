@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

@layer components {
  .btn-primary {
    @apply px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed;
  }
  .btn-secondary {
    @apply px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:bg-gray-200 disabled:cursor-not-allowed;
  }
  .btn-danger {
    @apply px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-red-300 disabled:cursor-not-allowed;
  }
  .label {
    @apply block text-sm font-medium text-gray-700 mb-1;
  }
  .input {
    @apply block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm;
  }
}

/* ========================================
   타이포그래피 시스템 (전역 베이스)
   ======================================== */
@layer base {
  /* Body 기본 폰트 크기 - Mobile First */
  body {
    @apply text-base; /* 15px (mobile), 16px (desktop) */
  }

  /* 입력 필드는 최소 16px 유지 (iOS 자동 줌 방지) */
  input,
  textarea,
  select {
    font-size: max(16px, 1rem);
  }

  /* 반응형 Heading 기본값 */
  h1 {
    @apply text-3xl font-bold; /* 24px */
  }
  h2 {
    @apply text-2xl font-semibold; /* 20px */
  }
  h3 {
    @apply text-xl font-semibold; /* 18px */
  }
  h4 {
    @apply text-lg font-medium; /* 16px */
  }
  h5 {
    @apply text-base font-medium; /* 15px */
  }
  h6 {
    @apply text-sm font-medium; /* 14px */
  }
}

/* Quill 에디터 전용 - 전역 통합 스타일 */
.ql-editor-readonly {
  @apply prose prose-sm lg:prose-base max-w-none;
}

/* ========================================
   CSS 변수 - 기본 테마 (iFA Teal)
   ======================================== */
:root {
  --color-primary-50: 230 249 244; /* #e6f9f4 */
  --color-primary-100: 199 240 230; /* #c7f0e6 */
  --color-primary-200: 160 229 212; /* #a0e5d4 */
  --color-primary-300: 110 212 191; /* #6ed4bf */
  --color-primary-400: 60 194 170;  /* #3cc2aa */
  --color-primary-500: 23 177 133;  /* #17B185 */
  --color-primary-600: 18 141 106;  /* #128d6a */
  --color-primary-700: 14 105 79;   /* #0e694f */
  --color-primary-800: 10 70 53;    /* #0a4635 */
  --color-primary-900: 6 35 26;     /* #06231a */
}

/* 전역 스타일 */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* body 폰트 설정은 위의 @layer base에서 처리됨 */
/* 추가 스타일만 여기 유지 */

/* iOS Safari 전용 스타일 */
@supports (-webkit-touch-callout: none) {
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
}

/* 커스텀 스크롤바 */
.custom-scrollbar::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 2px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: rgb(var(--color-primary-500));
  border-radius: 2px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: rgb(var(--color-primary-600));
}

/* 터치 피드백 */
.touch-feedback:active {
  transform: scale(0.98);
  transition: transform 0.1s ease;
}

/* 텍스트 선택 방지 */
.no-select {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* 로딩 스피너 */
.spinner {
  border: 3px solid rgba(var(--color-primary-200), 0.3);
  border-top: 3px solid rgb(var(--color-primary-600));
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* ===== 모바일 키보드 대응 스타일 ===== */

/* 키보드가 보일 때 body에 적용되는 클래스 */
body.keyboard-visible {
  /* 하단 네비게이션이나 고정 요소를 숨기려면 추가 */
}

/* 입력 필드 포커스 시 자동 스크롤을 위한 스타일 */
input:focus,
textarea:focus,
[contenteditable='true']:focus {
  scroll-margin-top: 80px; /* 상단 헤더 높이 + 여백 */
  scroll-margin-bottom: 100px; /* 키보드 위 여백 */
}

/* iOS Safari: 키보드 올라올 때 viewport 높이 문제 해결 */
@supports (-webkit-touch-callout: none) {
  /* iOS에서 키보드 올라올 때 fixed 요소 처리 */
  body.keyboard-visible .fixed-header,
  body.keyboard-visible .fixed-footer {
    position: absolute;
  }

  /* iOS에서 입력창이 키보드에 가려지는 문제 방지 */
  body.keyboard-visible {
    height: 100vh;
    overflow: hidden;
  }

  body.keyboard-visible .main-content {
    height: 100vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* 모바일 최적화: 입력 필드 확대 방지 (iOS) */
input[type='text'],
input[type='email'],
input[type='tel'],
input[type='number'],
input[type='password'],
input[type='search'],
textarea,
select {
  font-size: 16px; /* iOS에서 16px 미만이면 자동 줌 발생 */
}

/* 입력 필드 포커스 시 부드러운 전환 */
input,
textarea {
  transition:
    transform 0.3s ease,
    box-shadow 0.3s ease;
}

/* 포커스된 입력 필드 강조 */
input:focus,
textarea:focus {
  transform: translateY(0);
  outline: none;
  box-shadow: 0 0 0 3px rgba(var(--color-primary-500), 0.3);
}

/* 모바일에서 입력창 아래 여백 확보 */
.input-wrapper {
  margin-bottom: 20px;
  position: relative;
}

/* 키보드 올라올 때 하단 여백 추가 */
body.keyboard-visible .input-wrapper:last-child {
  margin-bottom: 300px; /* 키보드 높이만큼 */
}

/* 터치 영역 최적화 (최소 44x44px) */
button,
a {
  min-height: 44px;
  min-width: 44px;
}

/* 체크박스와 라디오 버튼은 기본 크기 유지 */
input[type='checkbox'],
input[type='radio'] {
  /* 기본 크기 사용 */
}

/* 작은 버튼의 경우 패딩으로 터치 영역 확대 */
.small-button {
  padding: 12px;
}

/* Visual Viewport API를 지원하는 브라우저용 */
@supports (height: 100dvh) {
  .full-height {
    height: 100dvh; /* Dynamic Viewport Height */
  }
}

/* 입력 필드 컨테이너 - 키보드 높이 계산 */
.keyboard-aware-container {
  min-height: 100vh;
  padding-bottom: env(safe-area-inset-bottom);
  padding-bottom: calc(
    env(safe-area-inset-bottom) + var(--keyboard-height, 0px)
  );
}

/* 플로팅 버튼이나 하단 고정 요소 */
.floating-action {
  position: fixed;
  bottom: 20px;
  transition: bottom 0.3s ease;
}

body.keyboard-visible .floating-action {
  bottom: calc(var(--keyboard-height, 0px) + 20px);
}

/* 애니메이션: 부드러운 스크롤 */
html {
  scroll-behavior: smooth;
}

/* 입력창 포커스 시 배경 강조 */
.input-focused-bg {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.3);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 40;
}

body.keyboard-visible .input-focused-bg {
  opacity: 1;
}
